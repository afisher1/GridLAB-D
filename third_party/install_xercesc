#!/bin/bash

if [ -f xerces*.gz -a ! -d xerces* ]; then
	echo "Uncompressing xerces*.gz..."
	gunzip xerces*.gz
fi
if [ -f xerces*.tar -a ! -d xerces* ]; then
	echo "Extracting xerces*.tar..."
	tar xvf xerces*.tar
fi
if [ "$(uname)" == "Darwin" ]; then
	cd xerces-c-3.1.1
	./configure CFLAGS="-arch x86_64" CXXFLAGS="-arch x86_64"
	make
	sudo make install
elif [ $(uname)" == "Linux" ]; then
	cd xerces-c-src_2_8_0
	export XERCESCROOT=`pwd`
	cd src/xercesc
	./runConfigure -plinux -cgcc -xg++ -minmem -nsocket -tnative -rpthread
	make
	cd ../..
	sudo cp -r include/xercesc /usr/include
	chmod -R a+rx /usr/include/xercesc
	sudo cp -f lib/* /usr/lib
	chmod -R a+rx /usr/lib/*xerces*
	sudo /sbin/ldconfig
fi
